{% extends 'diary/base.html' %}

{% block content %}
<h1>–í–∞—à–∏ –∫–Ω–∏–≥–∏</h1>
<a href="{% url 'book_create' %}" class="btn btn-success mb-3">–î–æ–±–∞–≤–∏—Ç—å –∫–Ω–∏–≥—É</a>

<ul class="list-group">
  {% for book in books %}
    <li class="list-group-item d-flex justify-content-between align-items-center clickable" data-url="{% url 'book_detail' book.pk %}">
      <!-- –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ -->
      <div class="d-flex align-items-center">
        <div class="book-cover me-3">
          <img src="https://kniga.lv/icache/b99834bc/67860a1c/0359cbdd.jpg" alt="–û–±–ª–æ–∂–∫–∞ –∫–Ω–∏–≥–∏" class="img-thumbnail">
        </div>
        <div>
          <h5 class="mb-1">{{ book.name }}</h5>
          <p class="mb-1 text-muted">{{ book.author }}</p>
          <small class="text-muted">{{ book.get_genre_display }}</small>
        </div>
      </div>
      <div>
        <small class="text-muted">{{ book.created_at|date:"d.m.Y H:i" }}</small>
      </div>
      <div>
        <a href="{% url 'book_delete' book.pk %}" class="btn  btn-danger">üóëÔ∏è</a>
      </div>
    </li>
  {% empty %}
    <p class="text-muted">–ü–æ–∫–∞ –Ω–µ—Ç –∫–Ω–∏–≥. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é!</p>
  {% endfor %}
</ul>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const clickableItems = document.querySelectorAll('.clickable');
    clickableItems.forEach(item => {
      item.addEventListener('click', function(event) {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ–±—ã –∫–ª–∏–∫ –Ω–µ –±—ã–ª –Ω–∞ –∫–Ω–æ–ø–∫–µ —É–¥–∞–ª–µ–Ω–∏—è
        if (!event.target.closest('a')) {
          window.location.href = this.dataset.url;
        }
      });
    });
  });
</script>
{% endblock %}
{% extends 'diary/base.html' %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">{% if form.instance.pk %}Редактировать{% else %}Добавить{% endif %} книгу</h2>
    
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.non_field_errors }}
        
        <!-- Поле загрузки обложки -->
        <div class="mb-3">
            <label for="{{ form.cover_image.id_for_label }}" class="form-label">Обложка книги</label>
            {{ form.cover_image }}
            <small class="form-text text-muted">Загрузите изображение обложки (JPG, PNG)</small>
            {% if form.cover_image.errors %}
                <div class="invalid-feedback d-block">
                    {{ form.cover_image.errors }}
                </div>
            {% endif %}
        </div>

        <!-- Поле "Автор" -->
        <div class="mb-3">
            <label for="{{ form.author.id_for_label }}" class="form-label">Автор*</label>
            {{ form.author }}
            {% if form.author.errors %}
                <div class="invalid-feedback d-block">
                    {{ form.author.errors }}
                </div>
            {% endif %}
        </div>

        <!-- Поле "Название" -->
        <div class="mb-3">
            <label for="{{ form.name.id_for_label }}" class="form-label">Название книги*</label>
            {{ form.name }}
            {% if form.name.errors %}
                <div class="invalid-feedback d-block">
                    {{ form.name.errors }}
                </div>
            {% endif %}
        </div>

        <!-- Поле "Жанр" -->
        <div class="mb-3">
            <label for="{{ form.genre.id_for_label }}" class="form-label">Жанр*</label>
            {{ form.genre }}
            {% if form.genre.errors %}
                <div class="invalid-feedback d-block">
                    {{ form.genre.errors }}
                </div>
            {% endif %}
        </div>

        <!-- Поле "Год издания" -->
        <div class="mb-3">
            <label for="{{ form.year.id_for_label }}" class="form-label">Год издания*</label>
            {{ form.year }}
            <small class="form-text text-muted">Год должен быть между 0  и 2100</small>
            {% if form.year.errors %}
                <div class="invalid-feedback d-block">
                    {{ form.year.errors }}
                </div>
            {% endif %}
        </div>

        <!-- Поле "Впечатления" -->
        <div class="mb-4">
            <label for="{{ form.impression.id_for_label }}" class="form-label">Ваши впечатления</label>
            {{ form.impression }}
            {% if form.impression.errors %}
                <div class="invalid-feedback d-block">
                    {{ form.impression.errors }}
                </div>
            {% endif %}
        </div>

<!-- Поле "Период чтения" -->
<div class="mb-4">
    <label class="form-label">Период чтения</label>
    <div class="d-flex align-items-center gap-2">
        <input type="date" name="{{ form.start_reading.name }}" id="{{ form.start_reading.id_for_label }}" 
               class="form-control" value="{{ form.start_reading.value|default:'' }}">
        <span>—</span>
        <input type="date" name="{{ form.end_reading.name }}" id="{{ form.end_reading.id_for_label }}" 
               class="form-control" value="{{ form.end_reading.value|default:'' }}">
    </div>
    {% if form.start_reading.errors or form.end_reading.errors %}
        <div class="invalid-feedback d-block">
            {{ form.start_reading.errors }}
            {{ form.end_reading.errors }}
        </div>
    {% endif %}
</div>

        <!-- Рейтинг в виде звёздочек -->
        <div class="form-group mb-3">
            <label>Рейтинг:</label>
            <div class="rating">
                <input type="radio" id="star1" name="rating" value="1" {% if form.instance.rating == 1 %}checked{% endif %}>
                <label for="star1">★</label>
                
                <input type="radio" id="star2" name="rating" value="2" {% if form.instance.rating == 2 %}checked{% endif %}>
                <label for="star2">★</label>
                
                <input type="radio" id="star3" name="rating" value="3" {% if form.instance.rating == 3 %}checked{% endif %}>
                <label for="star3">★</label>
                
                <input type="radio" id="star4" name="rating" value="4" {% if form.instance.rating == 4 %}checked{% endif %}>
                <label for="star4">★</label>
                
                <input type="radio" id="star5" name="rating" value="5" {% if form.instance.rating == 5 %}checked{% endif %}>
                <label for="star5">★</label>
            </div>
        </div>

        <div class="d-flex gap-2">
            <button type="submit" class="btn btn-primary">Сохранить</button>
            <a href="{% url 'book_list' %}" class="btn btn-outline-secondary">Отмена</a>
        </div>
    </form>
</div>


{% endblock %}